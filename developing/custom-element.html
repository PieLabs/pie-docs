
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Custom Element Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="controller.html" />
    
    
    <link rel="prev" href="development.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Using PIE Content
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../using/quick-start.html">
            
                <a href="../using/quick-start.html">
            
                    
                    Quick Start
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../using/defining-items.html">
            
                <a href="../using/defining-items.html">
            
                    
                    Defining Items
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../using/packaging-items.html">
            
                <a href="../using/packaging-items.html">
            
                    
                    Packaging Items
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../using/rendering-items.html">
            
                <a href="../using/rendering-items.html">
            
                    
                    Rendering Items
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../using/pie-player-api.html">
            
                <a href="../using/pie-player-api.html">
            
                    
                    PIE Player API
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    PIE Development
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="summary.html">
            
                <a href="summary.html">
            
                    
                    Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="development.html">
            
                <a href="development.html">
            
                    
                    Development
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.3" data-path="custom-element.html">
            
                <a href="custom-element.html">
            
                    
                    Custom Element
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="controller.html">
            
                <a href="controller.html">
            
                    
                    Controller
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="packaging.html">
            
                <a href="packaging.html">
            
                    
                    Packaging PIEs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="environment.html">
            
                <a href="environment.html">
            
                    
                    Environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="tutorial/development-tutorial.html">
            
                <a href="tutorial/development-tutorial.html">
            
                    
                    Devlopment Tutorial
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Authoring Development
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../authoring/authoring.html">
            
                <a href="../authoring/authoring.html">
            
                    
                    Development
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../authoring/uploader.html">
            
                <a href="../authoring/uploader.html">
            
                    
                    Uploader API
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../open-source-pies.html">
            
                <a href="../open-source-pies.html">
            
                    
                    Open Source PIEs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../design-decisions.html">
            
                <a href="../design-decisions.html">
            
                    
                    Design Decisions
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Custom Element</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="custom-element">Custom Element</h1>
<p>The user interface for a PIE is provided in the browser by a <a href="https://www.w3.org/TR/custom-elements/" target="_blank">Custom Element</a>.</p>
<p>It should be defined in an ES6 module which is included as the main entry point the package (see <a href="packaging.html">Packaging</a>)</p>
<blockquote>
<p>The most basic definition of an Element module is an ES6 module (CommonJS is also supported).
For information on developing and building your Custom Element module with framework support see <a href="using-modules.md">Using Modules</a></p>
</blockquote>
<pre><code class="lang-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPie</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HTMLElement</span> </span>{

  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">super</span>();
    <span class="hljs-keyword">this</span>._model = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>._session = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>._env = <span class="hljs-literal">null</span>;
  }

  set model(m) {
    <span class="hljs-keyword">this</span>._model = m;
  }

  get session() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._session;
  }

  set session(s) {
    <span class="hljs-keyword">this</span>._session = s;
  }

  set env(e) {
    <span class="hljs-keyword">this</span>._env = e;
  }

  connectedCallback() {
    <span class="hljs-comment">// the pie-player will capture this event and set the model and session properties</span>
    <span class="hljs-keyword">this</span>.dispatchEvent(<span class="hljs-keyword">new</span> CustomEvent(<span class="hljs-string">&apos;pie.register&apos;</span>, { bubbles: <span class="hljs-literal">true</span> }));   
  }
}
</code></pre>
<p>The Element receives properties that are set by the <a href="../GLOSSARY.html#pie-player" class="glossary-term" title="The PIE Player is a context that is provided in which PIEs can run. It sets data properties and handles events emitted by PIEs.">PIE Player</a> and may emit events to communicate out to the Player.</p>
<h3 id="reserved-element-properties">Reserved Element Properties</h3>
<p>As a developer of a PIE, you can define the configuration model for your Custom Element and the properties it will receive. However the two properties <code>model</code> and <code>session</code> are reserved. They will be set by the <code>pie-player</code> in the client and should not be defined as part of your configuration model.</p>
<h4 id="model"><code>model</code></h4>
<p>If you provide a controller with your PIE, then your controller will be called to set this property on your Custom Element, see <a href="controller.html">Controller</a>.</p>
<p>The controller is passed the complete configuration defined for the <a href="../GLOSSARY.html#assessment-item" class="glossary-term" title="An Assessment Item is one or several content, ui, question &amp; interaction elements configured by an author to present to a student.">assessment item</a>, along with the user&apos;s session data, and current <a href="environment.html">Environment</a> properties.</p>
<p>This allows you to set the model to an appropriate state based on the current settings. For example if in the <code>environment</code> property the <code>view</code> was set to <code>evaluate</code> you would need the correct responses to a question available in your model so your Custom Element can display information about the responses. Or if the environment indicated that the current user had certain accessibility requirements, you can modify the model to support those.</p>
<h4 id="session"><code>session</code></h4>
<p>The session property represents the state of a user&apos;s interaction with the PIE. If a setter is provided in the Custom Element this property will be set by the <a href="../GLOSSARY.html#pie-player" class="glossary-term" title="The PIE Player is a context that is provided in which PIEs can run. It sets data properties and handles events emitted by PIEs.">PIE player</a> when loading an <a href="../GLOSSARY.html#assessment-item" class="glossary-term" title="An Assessment Item is one or several content, ui, question &amp; interaction elements configured by an author to present to a student.">assessment item</a>. </p>
<p>The Element can modify this object and should emit a <code>sessionChanged</code> event (see below) when it does so, so that if need be the session response may be persisted.</p>
<p>As with <code>model</code> the structure of this data is entirely up to the developer of the PIE that uses it.</p>
<h4 id="env"><code>env</code></h4>
<p>The <code>env</code> property contains data that reflect the current user context. Any updates do these properties will be passed to the Custom Element by setting this property.</p>
<p>For a complete description of the properties in <code>env</code> see: <a href="environment.html">Environment</a></p>
<h3 id="custom-element-properties">Custom Element Properties</h3>
<p>If you do not provide a controller and only provide a Custom Element, your element may receive configuration data to its properties in two ways:</p>
<h4 id="json-configuration">JSON configuration</h4>
<p>config.json</p>
<pre><code class="lang-json">  ...
  models: [
    {
      <span class="hljs-string">&quot;id&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>,
      <span class="hljs-string">&quot;element&quot;</span>:<span class="hljs-string">&quot;my-pie&quot;</span>,
      <span class="hljs-string">&quot;fooBar&quot;</span>: <span class="hljs-string">&quot;some data&quot;</span>
    }
  ]
</code></pre>
<p>MyPie.js:</p>
<pre><code class="lang-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPie</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HTMLElement</span> </span>{
  set fooBar(value) {
    <span class="hljs-comment">// == &apos;some data&apos;</span>
  }
}
</code></pre>
<h3 id="events">Events</h3>
<p>A PIE should emit the following events:</p>
<h3 id="pieregister-event-required"><code>pie.register</code> Event (required)</h3>
<p>A PIE should emit this event when the Custom Element is connected in the DOM. This event is handled by the <a href="../GLOSSARY.html#pie-player" class="glossary-term" title="The PIE Player is a context that is provided in which PIEs can run. It sets data properties and handles events emitted by PIEs.">PIE Player</a> which will then set the <code>model</code> and <code>session</code> properties on the element.</p>
<h3 id="pieresponsecomplete-optional"><code>pie.responseComplete</code> (optional)</h3>
<p>This event should be emitted if the data captured from a user (stored in <code>session</code> property) is sufficient to consider the response complete.</p>
<p>For example, if you had a had a multi choice question that required the student to pick at least 3 choices you would emit this event when when 3 choices had been selected.</p>
<pre><code class="lang-javascript">    <span class="hljs-keyword">var</span> event = <span class="hljs-keyword">new</span> CustomEvent(<span class="hljs-string">&apos;pie.responseComplete&apos;</span>, {
      bubbles: <span class="hljs-literal">true</span>
    });

    <span class="hljs-keyword">this</span>.dispatchEvent(event);
</code></pre>
<h3 id="pieresponsechanged--optional"><code>pie.responseChanged</code>  (optional)</h3>
<p>This event should be emitted when the user respose has been modified, but not necessarily completed. 
Typically, the system hosting the Item using your PIE would be expected to persist the modified session upon receving this event.</p>
<pre><code class="lang-javascript">    <span class="hljs-keyword">var</span> event = <span class="hljs-keyword">new</span> CustomEvent(<span class="hljs-string">&apos;pie.responseChanged&apos;</span>, {
      bubbles: <span class="hljs-literal">true</span>
    });

    <span class="hljs-keyword">this</span>.dispatchEvent(event);
</code></pre>
<h3 id="brower-support">Brower Support</h3>
<p>Custom Elements are natively supported in Chrome and are available in other browsers via a polyfill. (Firefox = In development,  and Webkit = done - Dec 2016)</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="development.html" class="navigation navigation-prev " aria-label="Previous page: Development">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="controller.html" class="navigation navigation-next " aria-label="Next page: Controller">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Custom Element","level":"1.3.3","depth":2,"next":{"title":"Controller","level":"1.3.4","depth":2,"path":"developing/controller.md","ref":"developing/controller.md","articles":[]},"previous":{"title":"Development","level":"1.3.2","depth":2,"path":"developing/development.md","ref":"developing/development.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"INTRODUCTION.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"links":{"sharing":{"facebook":false,"twitter":false}},"gitbook":"3.x.x"},"file":{"path":"developing/custom-element.md","mtime":"2016-12-16T17:55:30.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-04-14T17:31:12.611Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

